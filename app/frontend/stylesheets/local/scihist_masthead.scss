/* We copy the masthead navbar from the main website at sciencehistory.org, and try to make it look the same...

   This was tricky.

   We had to figure out how to extract just what we need from their whole stylesheet,
   AND apply it on top of our site with different base styles so it still worksâ€¦

   we wound up with a lot of lines of kind of opaque code with strange our-app hacks on top.

   We are not using standard classes or inherited stles from the rest of OUR website,
   this mostly stands alone as it's own separate implementation, with some duplication.

   We do restrit these styles here to #shi-masthead-from-main-website to try to keep
   them from interfering with the rest of OUR site.

   This could be hard to maintain in the long-term, we will see. Best we could do!
*/

#shi-masthead-from-main-website {
    font: normal 400 1em/1.2 "SofiaPro","sans-serif";
    // reset to 20px/1.25 rem for kind-of consistency with main site where we copied
    // styles. this isn't actually exactly how CSS on main site works...
    //font-size: 1.25rem;

    // This should be proportional at 1.389vw, but
    // MIN 20px, which original did with a media query at min-width 1440px, but let's
    // do with CSS min instead, seems to have full support
    font-size: min(1.389vw, 20px);

    // change to 991px if we want to keep nav menus on one line until collapse
    @media screen and (max-width: 1199px) {
        font-size:1.6vw
        //font-size: min(1.6vw, 14px);
        //font-weight: 700 !important;
    }

    line-height: 1.2;


    // TOP BAR

    @media print {
        .noprint {
            display: none
        }
    }

    @media (hover: hover) {
        .shi-hover {
            transition: opacity .3s;
        }

        .shi-hover:hover {
            opacity: .7
        }
    }

    .shi-top-bar {
        width: 100%;
        padding: 0 4em;
        background-color: #1D242B;
        color: #fff;
        overflow: hidden
    }

    // We need to specifically override for dig col, since our base styles otherwise are here.
    .shi-top-bar a {
        color: inherit;
    }

    .shi-top-bar__container {
        width: 100%;
        height: 100%;
        max-width: 1280px;
        margin: 0 auto;
        position: relative;
        display: flex;
        justify-content: flex-end;
        // Don't know why have to comment this out to get it to stay within
        // bounds and horizontal scroll.
        //align-items: center;
        text-transform: uppercase
    }

    .shi-top-bar-nav {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
        align-items: center;
        margin-right: 1.15em;
        min-height: 2.15em;
        padding: .3em 0
    }

    .shi-top-bar-nav__item {
        text-decoration: none;
        // original site uses media queries to keep otherwise liquid proportional
        // font from going below minimum size, we just use css min() for similar.
        font-size: max(.77em, 14.3px);
        line-height: 136%;
        padding: .3571428571em 1.6428571429em
    }

    .shi-top-bar__hours {
        flex: 0 0 auto;
        // original site uses media queries to keep otherwise liquid proportional
        // font from going below minimum size, we just use css min() for similar.
        font-size: max(.77em, 14.3px);
        line-height: 136%;
        padding: .3571428571em 0 .3571428571em 3.2142857143em;
        position: relative;
        max-width: 40%
    }

    .shi-top-bar__hours:before {
        content: "";
        background-color: #285f70;
        position: absolute;
        left: 0;
        right: -9999px;
        top: -300%;
        bottom: -300%
    }

    .shi-top-bar__hours span {
        position: relative
    }

    .shi-top-bar__hours span:first-child {
        font-weight: 700;
        margin-right: .5em
    }

    @media screen and (max-width: 991px) {
        .shi-top-bar:not(.shi-top-bar_mobile) {
            padding-left: 15px;
            padding-right: 15px
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar-nav {
            //box-sizing: content-box;

            overflow-x: auto;
            width: auto;
            padding: 0;
            justify-content: flex-start;
            flex-wrap: nowrap;
            margin-left: -15px;
            margin-right: -15px;
            scroll-behavior: smooth;
            scrollbar-color: #fff rgba(0,0,0,0);
            scrollbar-width: thin
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar-nav::-webkit-scrollbar {
            height: 2px
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar-nav::-webkit-scrollbar-track {
            background-color: rgba(0,0,0,0)
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar-nav::-webkit-scrollbar-thumb {
            background-color: #fff
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar-nav::-webkit-scrollbar:vertical {
            display: none
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar-nav__item {
            flex: 0 0 auto;
            font-size: .89375em;
            line-height: 146%;
            padding-top: .7692307692em;
            padding-bottom: .7692307692em
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar__container {
            flex-direction: column-reverse
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar__hours {
            width: 100%;
            font-size: .89375em;
            padding: .7692307692em 0;
            line-height: 146%;
            text-align: center;
            max-width: none
        }

        .shi-top-bar:not(.shi-top-bar_mobile) .shi-top-bar__hours::before {
            top: 0;
            bottom: 0;
            left: -9999px
        }
    }

    // MAIN NAVBAR

    .header {
        position: relative;
        background: #fff;
        // horiz padding was 4em, but for consistency with our site, it's now
        // 30px at non-collapsed
        //padding: 1.05em 4em;
        padding: 1.05em 30px;

        // move max-width from header__wrapper to here, so we can
        // make it consistent with our existing site style.
        max-width: $main-container-max-width;
        margin: 0 auto;

        // fix to ~17px size. Original main site has dynamically scaling
        // font size with window size, we just arne't set up for that.
        // or... scale iwth it???
        //font-size: 1.0625rem;
    }

    .header__nav-close {
        display: none
    }

    .header__wrapper {
        //max-width: 1280px;

        //margin: 0 auto;
    }

    .header__inner {
        display: flex;
        justify-content: space-between;

        position: relative;
        align-items: center;
        flex-wrap: wrap;
    }

    .header__logo {
        flex: 0 0 auto;
        max-width: 19.15em;
        position: relative;
    }

    .img-middle {
        display: flex;
        align-items: center;
        justify-content: center
    }

    .img-middle img, .img-middle svg {
        display: block;
        flex-shrink: 0;
        width: auto;
        height: auto;
        max-height: 100%;
        max-width: 100%;
        margin: 0
    }

    .header__right-side {
        padding: .75em 0;
        display: flex;
        align-items: center
    }

    .header__menu-container {
        margin-right: 2.75em
    }

    .header__nav {
        display: flex;
        flex-wrap: wrap;
    }

    .header__nav-sandwich {
        position: relative;
        display: none;
        border: none;
        padding: 0;
        font-size: 1em;
        width: 1.0625em;
        height: 1.0625em;
        background-color: rgba(0,0,0,0);
        background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTciIGhlaWdodD0iMTUiIHZpZXdCb3g9IjAgMCAxNyAxNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE3IiBoZWlnaHQ9IjIuMjE3MzkiIGZpbGw9ImJsYWNrIi8+CjxyZWN0IHk9IjUuOTEyOTYiIHdpZHRoPSIxNyIgaGVpZ2h0PSIyLjIxNzM5IiBmaWxsPSJibGFjayIvPgo8cmVjdCB5PSIxMS44MjYiIHdpZHRoPSIxNyIgaGVpZ2h0PSIyLjIxNzM5IiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K);
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        transition: background-image .3s
    }

    .header__nav-sandwich span {
        display: none
    }

    .header__nav>ul {
        align-items: center;
        display: flex;
        flex-wrap: wrap;
        list-style-type: none;

        // added because original site had a reset with these on all ul
        padding: 0;
        margin: 0;
    }

    .header__nav ul li a {
        display: block;
        text-decoration: none;
        font-size: .935em;
        line-height: 2em
    }

    .header__nav>ul>li:not(.shi-item-bordered) {
        position: relative;
        margin-top: .4em;
        background: #fff;
        border: 2px solid rgba(0,0,0,0)
    }

    .header__nav>ul>li:not(.shi-item-bordered):nth-last-child(-n+3) ul.sub-menu {
        left: auto;
        right: -2px
    }

    .header__nav>ul>li:not(.shi-item-bordered).current-menu-item::after {
        opacity: 1
    }

    .header__nav>ul>li:not(.shi-item-bordered)::after {
        content: "";
        position: absolute;
        z-index: 3;
        bottom: .4em;
        left: calc(1.2941176471em - 2px);
        right: calc(1.2941176471em - 4px);
        height: 2px;
        background: #d7272e;
        opacity: 0;
        transition: opacity .3s
    }

    .header__nav>ul>li:not(.shi-item-bordered)>a {
        // original padding left was 1.1rem, but we have a different rem -- and ours
        // is static while there's is dyanamic! This was painstakingly adjusted
        // to come close to matching.
        padding: 0 1.17648em .4em
    }

    .header__nav>ul>li.shi-item-bordered {
        margin-left: .6em;
        margin-right: .6em
    }

    .header__nav>ul>li.shi-item-bordered>a {
        line-height: 1em;
        padding: .5294117647em .5882352941em;
        border: 1px solid #d7272e;
        transition: color .3s,background .3s
    }

    .header__nav>ul>li.shi-item-bordered ul.sub-menu {
        display: none !important
    }

    .header__nav>ul>li:last-child:not(.shi-item-bordered) {
        margin-right: -0.6em
    }

    .header__nav>ul>li>a {
        text-transform: uppercase;
        font-weight: 900;

        color: inherit;
    }

    // Hover bottom red border -- this is NOT how the original site handles it,
    // but is CSS that makes it look pretty close, and which we could figure out.
    .header__nav>ul>li:not(.shi-item-bordered)>a {
        &::after {
            content: "";
            display: block;
            border-bottom: 2px solid transparent;
            // Negative margin to try to keep it from shifting layout from original?
            //margin-bottom: -2px;
        }
        &:hover::after {
            content: "";
            display: block;
            border-bottom: 2px solid #D7272E;
        }
    }
    // And on the bordered 'support' button
    @media (hover: hover) {
       .header__nav>ul>li.shi-item-bordered:hover>a {
            background: #d7272e;
            color: #fff
        }
    }

    // not entirely clear why original CSS has special case here
    @media (orientation: landscape) and (max-height: 800px) and (min-width: 992px) {
        .header {
            padding-top: 1.5vh;
            padding-bottom: 1.5vh;
        }
        .header__logo {
            max-width: 15em
        }
        .header__right-side {
            padding: 0
        }
        .header__nav ul li a, .shi-top-bar__hours, .shi-top-bar-nav__item {
            // in original this was 15.4px, but we want to always do rem?
            font-size: 0.9625rem;
        }
    }



    // main bar COLLAPSE on small screen
    @media screen and (max-width: 991px) {
        // Main website seems to fix font-size at 16px once collapsed.
        // We'll do 1rem at our 16px rem
        font-size: 1rem;

        .header:not(.header_mobile) .header__nav-sandwich {
            display: block;
            font-size: 1em;
        }

       .header:not(.header_mobile) .header__menu-container {
            order: 2;
            margin-right: 0
        }

        .header:not(.header_mobile) {
            // for consisteny with our site, collapsed padding is
            // 15px horizontal.
            //padding: .8125em 1em .8125em 1.6875em
            padding: .8125em 15px .8125em 15px;
        }

        .header:not(.header_mobile) .header__inner {
            position: static;
            min-height: auto
        }

        .header:not(.header_mobile) .header__logo {
            width: 15.5625em
        }

        .header:not(.header_mobile) .header__nav {
            display: none;
            opacity: 0;
            position: absolute;
            background: #fff;
            z-index: 2;
            top: 0;
            left: 0;
            width: 100%;
            max-height: 100vh;
            overflow-y: auto;
            padding: 3.3125em 1.875em 2.5em;
            transition: opacity .3s
        }

        .header:not(.header_mobile) .header__nav-close {
            display: block;
            font-size: 1em;
            position: absolute;
            top: 1.9375em;
            padding: 0;
            margin: 0;
            border: none;
            box-shadow: none;
            background: rgba(0,0,0,0);
            width: 1.0625em;
            height: 1.0625em;
            right: 1em
        }

        .header:not(.header_mobile) .header__nav-close svg {
            display: block;
            width: 100%;
            height: 100%;
            -o-object-fit: contain;
            object-fit: contain
        }

        .header:not(.header_mobile) .header__nav>ul {
            align-items: flex-start;
            flex-direction: column
        }

        .header:not(.header_mobile) .header__nav>ul>li:not(.shi-item-bordered) {
            border: none;
            margin: 0;
            width: 100%;
        }

        .header:not(.header_mobile) .header__nav>ul>li:not(.shi-item-bordered)>a {
            padding: 0
        }

        .header:not(.header_mobile) .header__nav>ul>li:not(:first-child) {
            border-top: 1px solid #cfcfcf
        }

        .header:not(.header_mobile) .header__nav>ul>li.shi-item-bordered {
            border: none !important;
            margin: .3125em 0
        }

        .header:not(.header_mobile) .header__nav ul li a {
            font-weight: 700;
            line-height: 3.12em
        }

        .header:not(.header_mobile) .header__nav>ul>li.shi-item-bordered>a {
            margin-left: 0;
            padding: .8125em;
            line-height: 1em
        }

        // not from original site, our own hack to try to be similar.
        .header__nav ul li a {
            font-size: 1em;
        }
    }

    // Whole page margins (via padding) change in line with existing rest of our
    // site, 15px at small size, at bigger size (using bootstrap variable and
    // function), 30px
    @include media-breakpoint-up($layout-expand-up) {
        .header:not(.header_mobile) {
            padding-left: 30px;
            padding-right: 30px;
        }
    }

    // opened menu has .header with .header_menu-open
    .header_menu-open .header__nav {
        opacity: 1 !important
    }

    .header_menu-open .header__nav-sandwich {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkiIGhlaWdodD0iMTgiIHZpZXdCb3g9IjAgMCAxOSAxOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEgMUwxOC4wMDIyIDE3LjE5MDlNMTguMDAyMiAxTDEgMTcuMTkwOSIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjwvc3ZnPgo=)
    }

    .header_menu-prepare .header__nav {
        display: block !important;
    }


    // Our own custom dig coll masthead row, not part of SHI general branding
    .dig-col-product-masthead {
        // reset the fluid resized font thing from SHI header
        font-size: 1rem;

        padding-bottom: 3vh;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;

        column-gap: 2rem;
        row-gap: 0.4em;

        h1 a {
            font-size: min(2.5rem, 8vw);
            text-transform: uppercase;
            font-weight: 600;
            color: #D7272E;
            display: inline-block;
            margin: 0;
        }

        .search-form {
            width: 0;
            flex-grow: 1;
            min-width: 15em;
        }
    }
}
