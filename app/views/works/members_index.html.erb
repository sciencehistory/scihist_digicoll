<h1>Members: <%= @work.title %></h1>

<div class="alert alert-secondary d-inline-block">
  <h2 class="h4 alert-heading">Add New Members</h2>
  From:
  <%= link_to "Files", asset_ingest_path(@work), class: "btn btn-primary" %>
</div>

<p><%= @work.members.count  %> members</p>

<table class="table">
  <thead>
    <tr>
      <th>thumbnail</th>
      <th>ID</th>
      <th>Type</th>
      <th>Title</th>
      <th>Created</th>
      <th>Last Modified</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @work.members.order(:position).includes(:derivatives).each do |member| %>
      <tr>
        <td>
          <% if member.kind_of?(Kithe::Asset) && member.stored? && member.derivatives_created? %>
            <%= link_to show_asset_path(member) do %>
              <%= image_tag member.derivative_for(:thumb_standard).url,
                srcset: "#{member.derivative_for(:thumb_standard).url} 1x, #{member.derivative_for(:thumb_standard_2X).url} 2x" %>
            <% end %>
          <% end %>
        </td>

        <td><%= member.friendlier_id %></td>

        <td>
          <ul class="list-unstyled">
            <li><%= member.class.name %></li>
            <% if member.kind_of?(Kithe::Asset) %>
              <li><small><%= member.content_type %></small></li>
              <li><small><%= number_to_human_size(member.size) %></small></li>
              <% if ! member.stored? %>
                <li><small class="text-danger">waiting for ingest...</small></li>
              <% elsif  ! member.derivatives_created? %>
                <li><small class="text-danger">waiting for derivatives...</small></li>
              <% end %>
            <% end %>
          </ul>
        </td>

        </td>
        <td>
          <%= link_to show_asset_path(member) do %>
            <%= member.title %>
          <% end %>
        </td>
        <td><%= l member.created_at.to_date, format: :admin  %></td>
        <td><%= l member.updated_at.to_date, format: :admin %></td>
        <td>
          <%# link_to 'Edit', edit_work_path(work) %>
          <%# link_to 'Destroy', work, method: :delete, data: { confirm: 'Are you sure?' } %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>


