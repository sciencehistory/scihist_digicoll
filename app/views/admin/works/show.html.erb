


<%# form for submitting new sort order. We leave it without a url so it can't
    be accidentally submitted until our JS puts it in sort mode %>
<%= form_tag "", method: "put", remote: false,  data: { submit_url: reorder_members_for_admin_work_path(@work) } do |f| %>
  <div class="while-sorting-actions">
    <h2 class="h3">Drag to re-order</h2>
    <div>
      <%= link_to "Cancel", admin_work_path(@work), class: "btn btn-outline-primary" %>
      <button type="submit" class="btn btn-danger" disabled data-trigger="member-sort-save">Save</button>
    </div>
  </div>


  <div class="d-flex justify-content-between" data-hide-while-sorting="true">
    <div>
      <div>Managing a Work</div>
      <h1><%= @work.title %></h1>
      <% if @work.parent.present? %>
        <p>In: <%= link_to "#{@work.parent.title} (#{@work.parent.friendlier_id})", admin_work_path(@work.parent) %></p>
      <% end %>
    </div>

    <div class="alert alert-secondary mx-1">
      <h2 class="h4 alert-heading">
        <a data-toggle="collapse" href="#deleteBtn1" role="button" aria-expanded="false" aria-controls="deleteBtn1">
          Delete
        </a>
      </h2>
        <div class="collapse" id="deleteBtn1">
            <%= link_to('Delete', [:admin, @work], method: :delete,
                 data: { confirm: "Delete Work '#{@work.title}'?" }, class: "btn btn-danger" )%>
        </div>
    </div>
  </div>


<nav class="mb-2">
  <div class="nav nav-tabs" id="nav-tab" role="tablist">
    <a class="nav-item nav-link active" id="nav-metadata-tab" data-toggle="tab" href="#nav-metadata" role="tab" aria-controls="nav-home" aria-selected="true">Metadata</a>
    <a class="nav-item nav-link" id="nav-members-tab" data-toggle="tab" href="#nav-members" role="tab" aria-controls="nav-profile" aria-selected="false">Members</a>
  </div>
</nav>
<div class="tab-content" id="nav-tabContent">
  <div class="tab-pane show active" id="nav-metadata" role="tabpanel" aria-labelledby="nav-metadata-tab">

        <p>
          <%= link_to "Edit Metadata", edit_admin_work_path(@work), class: "btn btn-primary" %>
        </p>

        <p>Metadata TBD</p>

  </div>
  <div class="tab-pane" id="nav-members" role="tabpanel" aria-labelledby="nav-members-tab">
    <div class="admin-work-toolbar d-flex flex-wrap" data-hide-while-sorting="true">
      <div class="alert alert-secondary mx-1">
        <h2 class="h4 alert-heading">Add New Members</h2>
        From:
        <%= link_to "Files", admin_asset_ingest_path(@work), class: "btn btn-primary" %>
        <%= link_to "New Child Work", new_admin_work_path(parent_id: @work), class: "btn btn-primary" %>
      </div>

      <div class="alert alert-secondary mx-1" data-class="sort-controls">
        <h2 class="h4 alert-heading">Re-order Members</h2>
        <div class="sort-actions">
          <button type="button" class="btn btn-primary" data-trigger="member-sort">Manual</button>
          <%= link_to "Alphabetical", reorder_members_for_admin_work_path(@work), class: "btn btn-primary", data: { confirm: "Re-ordering members alphabetically by title can't be undone" } %>
        </div>
      </div>
    </div>

    <p><%= @work.members.count  %> members</p>

    <%= render "member_list_table", work: @work %>
  </div>
</div>
<% end %>
